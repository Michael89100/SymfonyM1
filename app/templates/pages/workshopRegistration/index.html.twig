{% extends 'base.html.twig' %}

{% block title %}Forum des m√©tiers - Inscription aux ateliers de
	{{ year }}
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<h1>Liste des ateliers de l'ann√©e
			{{year}}</h1>
		<div class="count mt-4">
			Il y a
			{{ workshopsWithEnrollment|length }}
			{% if workshopsWithEnrollment|length > 1 %}
				ateliers
			{% else %}
				atelier
			{% endif %}
			au total pour l'√©dition
			{{ year }}.
			<br>
			Vous √™tes inscrit √†
			{{registrationCount}}
			{% if registrationCount > 1 %}
				ateliers
			{% else %}
				atelier
			{% endif %}
			sur 3 maximum.
		</div>
		<table class="table mt-4">
			<thead>
				<tr class="table-dark">
					<th scope="col">Atelier</th>
					<th scope="col">Description</th>
					<th scope="col">Date & dur√©e</th>
					<th scope="col">Consulter</th>
				</tr>
			</thead>
			<tbody>
				{% for workshopData in workshopsWithEnrollment %}
					{% set workshop = workshopData.workshop %}
					{% set isEnrolled = workshopData.isEnrolled %}
					{% set isFinished = workshopData.isFinished %}
					{% set studentCount = workshopData.studentCount %}
					{% set roomCapacity = workshopData.roomCapacity %}
					{% set isFull = workshopData.isFull %}

					<tr class="{{ (isFinished) ? 'table-secondary' : (isFull) ? 'table-danger' : 'table-primary' }}">
						<td class="align-top">
							<strong>{{ workshop.name }}</strong>
							{% if isFinished %}
								<br><span class="badge bg-danger">Termin√©</span>
							{% endif %}
							{% if isFull %}
								<br><span class="badge bg-warning">Complet</span>
							{% else %}
								<br>Places :
								{{ studentCount }}
								/
								{{ roomCapacity }}
							{% endif %}
						</td>
						<td>{{ workshop.description}}<br>
							M√©tiers :
							{% for job in workshop.jobs %}
								<span class="badge bg-success">{{ job.name }}</span>
							{% endfor %}
							<br>
							Secteur :
							<span class="badge bg-info">{{ workshop.sector.name }}</span>
						</td>
						<td class="align-middle">{{ workshop.startAt | format_datetime(locale='fr') }}<br>
							{{ workshop.duration }}
							heures
						</td>
						<td class="align-middle">
							<a class="btn btn-success" href="{{ path('workshop-registration.show', {'id': workshop.id}) }}">Voir la fiche</a>
						</td>
					</tr>
				{% else %}
					<tr>
						<td class="table-warning" colspan="3">Pas d'ateliers trouv√©s üò±</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		<p>
			<div>
				Voir les ann√©es pr√©c√©dentes :
				<ul class="pagination pagination-sm">
					{% for y in years %}
						<li class="page-item {{ (y == year) ? 'active' : '' }}">
							<a class="page-link" href="{{ path('workshop-registration.index', {'year': y}) }}">{{ y }}</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		</p>

	</div>
{% endblock %}
